%% This is file `examvntu.cls', based on `extreport.cls' 
%% generated by Ovchinnikov Konstantin,
%%              Vinnitsa State Technical University, Ukraine.
%%
%%              k_ovchinnikov@mail.ru % 
%% 
%% The original source files were:
%% Copyright 1993 1994 1995 1996 1999
%% The LaTeX3 Project and any individual authors listed elsewhere 
%% in this file. 
%% 
%% This file may be distributed under the terms of the Latex Project
%% public licence
%% 
%% This system is distributed in the hope that it will be useful, 
%% but WITHOUT ANY WARRANTY; without even the implied warranty of 
%% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{examvntu}[2018/02/21 v1.0 Non Standard LaTeX class]

\LoadClass[14pt]{extreport}
\RequirePackage[T1,T2A]{fontenc}              
\RequirePackage[ukrainian]{babel}             
\RequirePackage[utf8]{inputenc}
\RequirePackage{forloop}
\RequirePackage{ulem}
\RequirePackage[paper=A4,pagesize]{typearea}
\RequirePackage[a4paper,left=2cm,right=1.5cm,top=1cm,bottom=2cm,layoutvoffset=0.5cm]{geometry}
\RequirePackage{tikz}
\RequirePackage{etoolbox}
\RequirePackage{enumitem}

\newcommand\ProtocolNumber[1]{\renewcommand\@ProtocolNumber{#1}}
\newcommand\@ProtocolNumber{7}
\newcommand\ProtocolDay[1]{\renewcommand\@ProtocolDay{#1}}
\newcommand\@ProtocolDay{22}
\newcommand\ProtocolMonth[1]{\renewcommand\@ProtocolMonth{#1}}
\newcommand\@ProtocolMonth{листопада}
\newcommand\ProtocolDMonth[1]{\renewcommand\@ProtocolDMonth{#1}}
\newcommand\@ProtocolDMonth{11}
\newcommand\ProtocolYear[1]{\renewcommand\@ProtocolYear{#1}}
\newcommand\@ProtocolYear{2017}

\newcommand\ChiefName[1]{\renewcommand\@ChiefName{#1}}
\newcommand\@ChiefName{Кучерук~В.~Ю.}
\newcommand\ChiefRName[1]{\renewcommand\@ChiefRName{#1}}
\newcommand\@ChiefRName{В.~Ю.~Кучерук}
\newcommand\ChiefDegree[1]{\renewcommand\@ChiefDegree{#1}}
\newcommand\@ChiefDegree{д.т.н.}
\newcommand\ChiefRank[1]{\renewcommand\@ChiefRank{#1}}
\newcommand\@ChiefRank{проф.}
\newcommand\ChiefDepartment[1]{\renewcommand\@ChiefDepartment{#1}}
\newcommand\@ChiefDepartment{метрології та \mbox{промислової} автоматики}
\newcommand\ChiefDepartmentAbbr[1]{\renewcommand\@ChiefDepartmentAbbr{#1}}
\newcommand\@ChiefDepartmentAbbr{МПА}

\newcommand\DeveloperName[1]{\renewcommand\@DeveloperName{#1}}
\newcommand\@DeveloperName{Овчинников~К.~В.}
\newcommand\DeveloperDegree[1]{\renewcommand\@DeveloperDegree{#1}}
\newcommand\@DeveloperDegree{к.т.н.}
\newcommand\DeveloperRank[1]{\renewcommand\@DeveloperRank{#1}}
\newcommand\@DeveloperRank{доц.}
\newcommand\DeveloperDepartment[1]{\renewcommand\@DeveloperDepartment{#1}}
\newcommand\@DeveloperDepartment{метрології та \mbox{промислової} автоматики}
\newcommand\DeveloperDepartmentAbbr[1]{\renewcommand\@DeveloperDepartmentAbbr{#1}}
\newcommand\@DeveloperDepartmentAbbr{МПА}
\newcommand\DeveloperFaculty[1]{\renewcommand\@DeveloperFaculty{#1}}
\newcommand\@DeveloperFaculty{комп'ютерних систем і автоматики}
\newcommand\DeveloperUniversity[1]{\renewcommand\@DeveloperUniversity{#1}}
\newcommand\@DeveloperUniversity{Вінницький національний технічний університет}
\newcommand\DeveloperUniversityAbbr[1]{\renewcommand\@DeveloperUniversityAbbr{#1}}
\newcommand\@DeveloperUniversityAbbr{ВНТУ}
\newcommand\DeveloperMinistry[1]{\renewcommand\@DeveloperMinistry{#1}}
\newcommand\@DeveloperMinistry{Міністерство освіти і науки України}

\newcommand\StudentLevel[1]{\renewcommand\@StudentLevel{#1}}
\newcommand\@StudentLevel{бакалавр}
\newcommand\StudentDiscipline[1]{\renewcommand\@StudentDiscipline{#1}}
\newcommand\@StudentDiscipline{Обчислювальна техніка та програмування}
\newcommand\StudentProfessionCode[1]{\renewcommand\@StudentProfessionCode{#1}}
\newcommand\@StudentProfessionCode{6.051001}
\newcommand\StudentProfessionName[1]{\renewcommand\@StudentProfessionName{#1}}
\newcommand\@StudentProfessionName{Метрологія та інформаційно-вимірювальні технології}
\newcommand\StudentSemester[1]{\renewcommand\@StudentSemester{#1}}
\newcommand\@StudentSemester{4}
\newcommand\StudentCtrlForm[1]{\renewcommand\@StudentCtrlForm{#1}}
\newcommand\@StudentCtrlForm{іспит}

\newcounter{curritem}
\setcounter{curritem}{1}
 
\newcounter{TotalNum}            
\setcounter{TotalNum}{20}  %кол-во билетов

\newcounter{nbilet}
\newcommand{\BILET}{
\addtocounter{nbilet}{1}%
 \begin{center}
 {\bf Екзаменаційний білет №\uline{~\arabic{nbilet}~}}
 \end{center}
}

\newcommand\lengthof[1]{\csname pgfmath@randomlist@#1\endcsname}
\newcommand\nthof[2]{\csname pgfmath@randomlist@#2@#1\endcsname}

\def\qfirstlist{%
{I - 1?}%
{I - 2?}%
{I - 3?}%
{I - 4?}%
{I - 5?}%
{I - 6?}%
{I - 7?}%
{I - 8?}%
{I - 9?}%
{I - 10?}%
}

\def\qsecondlist{%
{II - 1?}%
{II - 2?}%
{II - 3?}%
{II - 4?}%
{II - 5?}%
{II - 6?}%
{II - 7?}%
{II - 8?}%
{II - 9?}%
{II - 10?}%
}

\newcommand\declarelist[1]{
 \expandafter\let\expandafter\tmp\csname q#1\endcsname
 \pgfmathdeclarerandomlist{#1}{\tmp}}

\declarelist{firstlist}
\declarelist{secondlist}

\def\prunelist#1{
 \expandafter\xdef\csname pgfmath@randomlist@#1\endcsname
         {\the\numexpr\csname pgfmath@randomlist@#1\endcsname-1\relax}
 \count@\pgfmath@randomtemp 
 \loop
  \expandafter\global\expandafter\let
  \csname pgfmath@randomlist@#1@\the\count@\expandafter\endcsname
  \csname pgfmath@randomlist@#1@\the\numexpr\count@+1\relax\endcsname
  \ifnum\count@<\csname pgfmath@randomlist@#1\endcsname\relax
  \advance\count@\@ne
 \repeat}

\newcommand\printfrom[1]{
 \pgfmathrandomitem\z{#1}
  \z
  \prunelist{#1}
 \ifnum \lengthof{#1} = 0 \declarelist{#1} \fi
}

\newcommand\printexamtitle{
\pagestyle{empty}
\begin{flushright}
Затверджую\\
завідувач кафедри \@DeveloperDepartmentAbbr\\
\uline{\makebox[4cm][c]{~}} \@ChiefRName\\
протокол № \uline{~\@ProtocolNumber~} від \uline{~\@ProtocolDay.\@ProtocolDMonth.\@ProtocolYear~р.}\\
\end{flushright}
\begin{center}
Спеціальність: \@StudentProfessionCode~--~\@StudentProfessionName\\
Навчальний предмет: <<\@StudentDiscipline>>\\
\vspace{0.5cm}
\textbf{Питання на \@StudentCtrlForm}\\
\end{center}
\begin{enumerate}[noitemsep]
\foreach \i in {1, ..., \lengthof{firstlist}}
   {%\par\arabic{curritem}.~\nthof{\i}{firstlist}
   \item \nthof{\i}{firstlist}
   \addtocounter{curritem}{1}
   }
\foreach \i in {1, ..., \lengthof{secondlist}}
   {%\par\arabic{curritem}.~\nthof{\i}{secondlist}
   \item \nthof{\i}{secondlist}
   \addtocounter{curritem}{1}
   }
\end{enumerate}   
\vspace{1.5cm}
\parЕкзаменатор \uline{\makebox[4cm][c]{~}} \@DeveloperName  
\newpage
}

\newcommand\printexamquestions{
\pagestyle{empty}
\newcounter{ct}
\forloop{ct}{0}{\value{ct} < \value{TotalNum}}
{
 \noindent
 \fbox{
 \begin{minipage}{\textwidth}
 \hfill{\bf Форма №Н-5.05}
 \uline{\makebox[\textwidth][c]{\@DeveloperUniversity}}\\
 {\scriptsize\makebox[\textwidth][c]{(повне найменування вищого навчального закладу)}}\\
  
   \hfill
   \begin{minipage}{0.9\textwidth}
    \small
    Освітньо-кваліфікаційний рівень \uline{\@StudentLevel\hfill}\\
    Напрям підготовки \uline{\@StudentProfessionCode~--~\@StudentProfessionName\hfill}\\
    Семестр \uline{~\@StudentSemester\hfill}\\
    Навчальна дисципліна \uline{\@StudentDiscipline\hfill}\\
   \end{minipage}
  \BILET
   \begin{enumerate}
    \item \printfrom{firstlist}
    \item \printfrom{secondlist}
   \end{enumerate}
  \footnotesize
  Затверджено на засіданні кафедри \@DeveloperDepartmentAbbr\\
  Протокол №{~\@ProtocolNumber~}від{~<<\@ProtocolDay>>}~\@ProtocolMonth~\@ProtocolYear~р.\\
   \begin{tabbing}
   \hspace*{5cm}\=\hspace*{4cm}\= \kill
    \makebox[4.8cm][r]{{\bf Завідувач кафедри \@DeveloperDepartmentAbbr}} \> \uline{\makebox[3cm][c]{}} \> \uline{\makebox[5cm][c]{\@ChiefName}} \\
    ~ \> \scriptsize\makebox[3cm][c]{(підпис)} \> \scriptsize\makebox[5cm][c]{(прізвище та ініціали)}\\
    \makebox[4.8cm][r]{{\bf Екзаменатор}} \> \uline{\makebox[3cm][c]{~}} \> \uline{\makebox[5cm][c]{\@DeveloperName}} \\
    ~ \> \scriptsize\makebox[3cm][c]{(підпис)} \> \scriptsize\makebox[5cm][c]{(прізвище та ініціали)}\\
   \end{tabbing}
 \end{minipage}}
}%forloop
}